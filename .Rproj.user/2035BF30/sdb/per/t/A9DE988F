{
    "collab_server" : "",
    "contents" : "alpha <- FALSE\n#  ------------------------------------------------------------------------\nlibrary(readr)\nlibrary(dplyr)\nlibrary(stringr)\nunchanged <- sysmsg <- read_delim(\"systemmsg-e.txt\", '\\t', col_types = list(col_integer(), col_integer(), col_character(), col_integer(), col_character(), col_character(), col_character(), col_character(), col_character(), col_character(), col_integer(), col_integer(), col_integer(), col_integer(), col_integer(), col_character(), col_character()))\nif (alpha) sysmsg <- sysmsg %>% mutate(message = paste0('<',id, '>', message))\n# Functions ---------------------------------------------------------------\nfind_id <- function(string) {\n  Result <- unchanged %>% filter(str_detect(str_to_lower(message),str_to_lower(string))) %>% .[[\"id\"]]\n  if (length(Result) == 0) warning(paste0('Could not find lines with string \"', string, '\".'), call. = FALSE)\n  return(Result)\n}\nchange_color <- function(vID = NULL, value = NULL){\n  if(!is.null(value)){\n    if(is.null(vID)) vID <- sysmsg$id\n    if(is.character(vID)) vID <- find_id(vID)\n    value <- value %>% str_replace('0x', '') %>% str_to_upper()\n    if (str_detect(value, '[^[0-9A-F]]')) stop('Values overreach hexadecimal maximum [0-9A-F]')# yra neleistinu simboliu\n    \n    if (str_length(value) < 6) stop('String doesnt reach length of 6, minimum requirement.')\n    if (str_length(value) > 6) warning('String exceeds length of 6.')\n    sysmsg <<- sysmsg %>% mutate(`rgba[0]` = replace(`rgba[0]`, id %in% vID, str_sub(value, 5, 6)))\n    sysmsg <<- sysmsg %>% mutate(`rgba[1]` = replace(`rgba[1]`, id %in% vID, str_sub(value, 3, 4)))\n    sysmsg <<- sysmsg %>% mutate(`rgba[2]` = replace(`rgba[2]`, id %in% vID, str_sub(value, 1, 2)))\n  }\n  return(vID)\n}\nchange_sound <- function(vID = NULL, value = NULL){\n  if(!is.null(value)){\n    if(is.null(vID)) vID <- sysmsg$id\n    if(is.character(vID)) vID <- find_id(vID)\n    sysmsg <<- sysmsg %>% mutate(item_sound = replace(item_sound, id %in% vID, value))\n  }\n  return(value)\n}\nchange_text <- function(vID = NULL, value = NULL){\n  if(!is.null(value)){\n    if(is.null(vID)) vID <- sysmsg$id\n    if(is.character(vID)) vID <- find_id(vID)\n    if(value == '') change_sound(vID, '')\n    sysmsg <<- sysmsg %>% mutate(message = replace(message, id %in% vID, value))\n    \n  }\n  return(vID)\n}\nchange_group <- function(vID = NULL, value = NULL) {\n  # 0,1,2  - system\n  # 3      - damage\n  # 4      - table [ok][ok/cancel]\n  # 5      - damage and consumables\n  # 6      - petition\n  # 7      - consumables\n  if(!is.null(value)){\n    if(is.null(vID)) vID <- sysmsg$id\n    if(is.character(vID)) vID <- find_id(vID)\n    if (class(value)=='character'){\n      # system = 0\n      # damage = 3\n      # consumables = 7\n      value <- switch(str_sub(str_to_lower(value),1,1),s = 0,d = 3,t = 4,b = 5,p = 6,c = 7,stop('Not supported variable group value.'))\n    } else {\n      if (class(value)=='numeric'){\n        if(value > 7 || value < 0) stop('Value out of supported range.')\n      } else\n        stop(paste0('Class of value not supported. class = ', class(value), ', value = ', value))\n    }\n    sysmsg <<- sysmsg %>% mutate(group = replace(group, id %in% vID, value))\n  }\n  return(vID)\n}\nchange_on_screen <- function(vID = NULL, value = NULL, pos = NULL, time = 0, do_fadeout = 0){\n  if(!is.null(value)){\n    if(is.null(vID)) vID <- sysmsg$id\n    if(is.character(vID)) vID <- find_id(vID)\n    do_fadeout <- as.numeric(do_fadeout)\n    sysmsg <<- sysmsg %>% mutate(sub_msg = replace(sub_msg, id %in% vID, value))\n    sysmsg <<- sysmsg %>% mutate(`UNK_1[0]` = replace(`UNK_1[0]`, id %in% vID, pos))\n    sysmsg <<- sysmsg %>% mutate(`UNK_1[2]` = replace(`UNK_1[2]`, id %in% vID, time))\n    sysmsg <<- sysmsg %>% mutate(`UNK_1[3]` = replace(`UNK_1[3]`, id %in% vID, do_fadeout))\n  }\n}\nchange_line <- function(vID = NULL, text = NULL, group = NULL, color = NULL){\n  change_text(vID, text)\n  change_group(vID, group)\n  change_color(vID, color)\n}\nfind_line <- function(string) {\n  if(is.numeric(string)){\n    ind <- string \n  } else\n    ind <- find_id(string)\n  sysmsg %>% filter(id %in% ind)\n}\n# Default colours ---------------------------------------------------------\n## Uninportant\nuninportant <- '222222'\ngrey <- '333333'\nred <- 'FF0000'\nredish <- '661111'\ngreen <- '00FF00'\nblue <- '0000FF'\n\ndrop <- 'FFFF00'\nadena <- drop\nspoil <- 'cc9900'\nenchant <- drop\n# other\n  expsp <- '999900'\n  party <- '5500AA'\n  clan <- '000000'\nplayers <- '12569F'\n  trade <- green\n  shop <- green\n## Fighting       \n###\n  equip <- '59A655'\n  equip_off <- '101010'\nimportant_things <- '555500'\nwhite <- 'FFFFFF'\n### Damage\nkibo_debufas <- '11dd41'\ndamage_out <- '4444dd'\ndamage_in <- 'FF0000'\n### HP/MP/CP\nmp_recovery <- '2E8AB6'\nmp_lackof <- '0000FF'\nhp_recovery <- 'B6772E'\nhp_lackof <- 'FF0000'\n### buffs\nbuff_on <- '333366'\nbuff_off <- '660033'\n# Changes -----------------------------------------------------------------\n### Server stuff\n   1 %>% change_line('The server will be coming down in $s1 second(s).  Please find a safe place to log out.', 'system', red)\n   3 %>% change_line('$s1 is not currently logged in.', 'system', red)\n  94 %>% change_line(\"swxkatu\", 's', redish) # Welcome to the L2NEO! www.l2neo.com\n 101 %>% change_line(\"You cannot exit while in combat.\", 's', red)\n 102 %>% change_line(\"You cannot restart while in combat.\", 's', red)\n 125 %>% change_line(\"Exit?\") # Do you wish to exit the game?\n 126 %>% change_line(\"Restart?\") # Do you wish to exit to the character select screen?\n 127 %>% change_line(\"You have been disconnected from the server.\") # You have been disconnected from the server. Please login again.\n 176 %>% change_line(\"That person is in message refusal mode.\", 's', red)\n 214 %>% change_line(\"Your title has been changed.\", 's', red) %>% change_on_screen(value = 'Your title has been changed.', pos = 5, time = 2, do_fadeout = 0)\n### Remove\n  34 %>% change_line(\"\") # Welcome to the World of Lineage II.\n  41 %>% change_line(\"\") # You carefully nock an arrow.\n  47 %>% change_line(\"\") # You begin to use a(n) $s1.\n  48 %>% change_line(\"\") # $s1 is not available at this time: being prepared for reuse.\n 109 %>% change_line(\"\") # Invalid target.\n 110 %>% change_line(\"\") # [+] $s1  # The effects of $s1 flow through you.\n 144 %>% change_line(\"\") # That is the incorrect target.\n 342 %>% change_line(\"\") # Power of the spirits enabled.\n 533 %>% change_line(\"\") # Power of Mana enabled.\n1017 %>% change_line(\"\") # Pet's critical hit!\n1028 %>% change_line(\"\") # Summoned monster's critical hit!\n### OnScreen only\n 181 %>% change_line(\"\", color = red) %>% change_on_screen(value = \"Can't see.\", pos = 7, do_fadeout = 0, time = 1) # Cannot see target.\n### Pick\n  28 %>% change_line('You have obtained $s1 adena.', 's', adena)\n  29 %>% change_line('You have obtained $s2 $s1.', 's', drop)\n  30 %>% change_line('You have obtained $s1.', 's', drop)\n  52 %>% change_line(\"You have earned $s1 adena.\", 's', adena)\n  53 %>% change_line(\"You have earned $s2 $s1(s).\", 's', drop)\n  54 %>% change_line(\"You have earned $s1.\", 's', drop)\n 608 %>% change_line(\"$s1 has obtained $s3 $s2 by using Sweeper.\", 's', drop)\n  55 %>% change_line(\"You have failed to pick up $s1 adena.\", 'c', red)\n  56 %>% change_line(\"You have failed to pick up $s1.\", 'c', red)\n  57 %>% change_line(\"You have failed to pick up $s2 $s1(s).\", 'c', red)\n  58 %>% change_line(\"You have failed to earn $s1 adena.\", 'c', red)\n  59 %>% change_line(\"You have failed to earn $s1.\", 'c', red)\n  60 %>% change_line(\"You have failed to earn $s2 $s1(s).\", 'c', red)\n  62 %>% change_line(\"Your $s1 has been successfully enchanted.\", 's', enchant)\n  63 %>% change_line(\"Your +$S1 $S2 has been successfully enchanted.\", 's', enchant)\n  64 %>% change_line(\"The enchantment has failed!  Your $s1 has been crystallized.\", 's', red)\n  65 %>% change_line(\"The enchantment has failed!  Your +$s1 $s2 has been crystallized.\", 's', red)\n 277 %>% change_line(\"You have learned $s1.\", 's', important_things)\n 298 %>% change_line(\"You have dropped $s1.\", 's', red)\n 299 %>% change_line(\"$s1 has obtained $s3 $s2.\", 's', drop)\n 300 %>% change_line(\"$s1 has obtained $s2.\", 's', drop)\n 369 %>% change_line(\"You have obtained a +$s1 $s2.\", 's', drop)\n 375 %>% change_line(\"You have dropped +$s1 $s2.\", 's', red)\n 376 %>% change_line(\"$s1 has obtained +$s2$s3.\", 's', drop)\n 370 %>% change_line(\"Failed to pick up $s1.\", 's', redish)\n 371 %>% change_line(\"Acquired +$s1 $s2.\", 's', drop)\n 372 %>% change_line(\"Failed to earn $s1.\", 's', redish)\n 608 %>% change_line(\"$s1 spoiled $s3 $s2.\", 's', spoil) # $s1 has obtained $s3 $s2  by using Sweeper.\n 609 %>% change_line(\"$s1 spoiled $s2.\", 's', spoil) # $s1 has obtained $s2 by using Sweeper.\n 672 %>% change_line(\"$s1 adena disappeared.\", 'c') \n### EXP SP\n  45 %>% change_line(\"You have earned $s1 experience.\", 'c', expsp)\n  95 %>% change_line(\"You have earned $s1 experience and $s2 SP.\", 'c', expsp)\n 331 %>% change_line(\"You have acquired $s1 SP.\", 'c', expsp)\n 362 %>% change_line(\"You have acquired $s1 bonus experience from a successful over-hit.\", 'c', expsp)\n### Trade\n 121 %>% change_line(\"$s1 has confirmed the trade.\", 's', color = green)\n 123 %>% change_line(\"Your trade is successful.\", 's', color = green)\n 124 %>% change_line(\"$s1 has canceled the trade.\", 's', color = red)\n 142 %>% change_line(\"You are already trading with someone.\", 's', color = redish)\n 143 %>% change_line(\"$s1 is already trading with another person. Please try again later.\", 's', color = redish)\n 174 %>% change_line(\"That person's inventory is full.\", 's', color = red)\n### Players\n 131 %>% change_line(\"$s1 has logged in.\", 's', players)\n 145 %>% change_line(\"That player is not online.\", 's', players)\n 503 %>% change_line(\"$s1 (Friend) has logged in.\", 's', players)\n1359 %>% change_line(\"$s1 has logged in.\", 's', players)\n### Party\n 105 %>% change_line(\"You have invited $s1 to your party.\", 's', party)\n 106 %>% change_line(\"You have joined $s1's party.\", 's', party)\n 107 %>% change_line(\"$s1 has joined the party.\", 's', green)\n 108 %>% change_line(\"$s1 has left the party.\", 's', red)\n 152 %>% change_line(\"You have invited the wrong target.\", 's', redish)\n 153 %>% change_line(\"$s1 is busy. Please try again later.\", 's', redish)\n 154 %>% change_line(\"Only the leader can give out invitations.\", 's', redish)\n 155 %>% change_line(\"The party is full.\", 's', red)\n 160 %>% change_line(\"$s1 is a member of another party and cannot be invited.\", 's', red)\n 161 %>% change_line(\"That player is not currently online.\", 's', redish)\n 164 %>% change_line(\"Waiting for another reply.\", 's', party)\n 185 %>% change_line(\"You must first select a user to invite to your party.\", 's', redish)\n 200 %>% change_line(\"You have withdrawn from the party.\", 's', party)\n 201 %>% change_line(\"$s1 was expelled from the party.\", 's', party)\n 202 %>% change_line(\"You have been expelled from the party.\", 's', party)\n 203 %>% change_line(\"The party has dispersed.\", 's', party)\n 305 %>% change_line(\"The player declined to join your party.\", 's', party)\n1384 %>% change_line(\"$s1 has become the party leader.\", 's', party)\n### Clan\n 191 %>% change_line(\"Clan member $s1 has been expelled.\", 's', red)\n 193 %>% change_line(\"Clan has dispersed.\", 's', red)\n 222 %>% change_line(\"$s1 has joined the clan.\", 's', green)\n 223 %>% change_line(\"$s1 has withdrawn from the clan.\", 's', red)\n 304 %>% change_line(\"Clan member $s1 has logged into game.\", 'c', players)\n### Damage\n  35 %>% change_line('You hit for $s1 damage.', 'd', damage_out)\n  36 %>% change_line('$s1 hit you for $s2 damage.', 'd', damage_in)\n  37 %>% change_line('$s1 hit you for $s2 damage.', 'd', damage_in)\n1866 %>% change_line('MP reduced by $s1.', 's', damage_in) # MP was reduced by $s1.\n 296 %>% change_line('You received $s1 damage from taking a high fall.', 'd', damage_in)\n 297 %>% change_line('You have taken $s1 damage because you were unable to breathe.', 'd', damage_in)\n 333 %>% change_line(\"You have received $s1 damage by Core's barrier.\", 'd', damage_in)\n 812 %>% change_line('The secret trap has inflicted $s1 damage on you.', 'd', damage_in)\n1014 %>% change_line('Your pet gained $s1 experience points.', 'c', white)\n1015 %>% change_line('Your pet hit for $s1 damage.', 'd', damage_out)\n1016 %>% change_line('Your pet received $s2 damage caused by $s1.', 'd', damage_in)\n1026 %>% change_line('The summoned monster gave damage of $s1.', 'd', damage_out)\n1027 %>% change_line('The summoned monster received damage of $s2 caused by $s1.', 'd', damage_in)\n1069 %>% change_line('$s2 MP by $s1.', 'd', mp_recovery) # $s2 MP has been restored by $s1.\n\n### Fails\n  22 %>% change_line('Your target is out of range.', 's', white)\n  23 %>% change_line('Not enough HP.', 'd', hp_lackof)\n  24 %>% change_line('Not enough MP.', 'd', mp_lackof)\n  43 %>% change_line(\"You have missed.\", 'd', white)\n  50 %>% change_line(\"Your target cannot be found.\", 'd', red)\n  51 %>% change_line(\"You cannot use this on yourself.\", 's', red)\n 112 %>% change_line(\"You have run out of arrows.\", 's', red)\n 113 %>% change_line(\"$s1 cannot be used due to unsuitable terms.\", 'd', red)\n 156 %>% change_line(\"Drain was only 50 percent successful.\", 'd', red)\n 129 %>% change_line(\"Your inventory is full.\", 's', red)\n 130 %>% change_line(\"Your warehouse is full.\", 's', red)\n \n  27 %>% change_line('Your casting has been interrupted.', 'd', important_things)\n 139 %>% change_line(\"$s1 has resisted your $s2.\", 'd', red) \n 158 %>% change_line(\"Your attack has failed.\", 'd', red) \n1597 %>% change_line(\"$s1 failed.\", 'd', red)\n### Successes \n\n1066 %>% change_line('+$s1 HP.', 's', hp_recovery) # $s1 HP has been restored.\n1405 %>% change_line('+$s1 CP.', 's', hp_recovery) # $s1 CPs have been restored.\n\n  25 %>% change_line('Rejuvenating HP.', 'c', white)\n  26 %>% change_line('Rejuvenating MP.', 'c', white)\n  42 %>% change_line(\"You have avoided $s1's attack.\", 'c', white)\n  44 %>% change_line(\"Critical hit!\", 'd', white)\n1280 %>% change_line(\"Magic Critical Hit!\", 'd', white)\n  96 %>% change_line(\"Your level has increased!\", 's', expsp)\n 111 %>% change_line(\"Your shield defense has succeeded.\", 's', white)\n 157 %>% change_line(\"You resisted $s1's drain.\", 'd', green)\n 159 %>% change_line(\"You have resisted $s1's magic.\", 'd', green)\n 361 %>% change_line(\"Over-hit!\", 'c', white)\n \n 357 %>% change_line(\"It has already been spoiled.\", 'd', green)\n 612 %>% change_line(\"Spoil activated!\", \"d\", kibo_debufas) %>% change_on_screen(value = \"active!\", pos = 8, time = 1)\n1595 %>% change_line(\"$s1 has succeeded.\", \"d\", kibo_debufas) %>% change_on_screen(\"$s1 on!\", pos = 8, time = 1)\n### Equip\n  49 %>% change_line(\"You have equipped your $s1.\", 's', equip)\n 368 %>% change_line(\"Equipped +$s1 $s2.\", 's', equip)\n 417 %>% change_line(\"$s1  has been disarmed.\", 's', equip)\n 377 %>% change_line(\"$S1 $S2 disappeared.\", 's', grey)\n1064 %>% change_line(\"The equipment, +$s1 $s2, has been removed.\", 's', equip_off)\n1433 %>% change_line('$s1 activated.', 's', equip) # The automatic use of $s1 has been activated.\n1434 %>% change_line('$s1 deactivated.', 's', equip_off) # The automatic use of $s1 has been deactivated.\n### Zariche\n1815 %>% change_line(\"$s2 was dropped in the $s1 region.\", 'c', white) %>% change_on_screen(value = '$s2 dropped $s1.', pos = 8, time = 3)\n1816 %>% change_line(\"The owner of $s2 has appeared in the $s1 region.\", 'c', white) %>% change_on_screen(value = '$s2 in $s1.', pos = 8, time = 3)\n1817 %>% change_line(\"$s2's owner has logged into the $s1 region.\", 'c', white) %>% change_on_screen(value = '$s2 logged in $s1.', pos = 8, time = 3)\n1818 %>% change_line(\"$s1 has disappeared.\", 'c', white) %>% change_on_screen(value = '$s1 disappeared.', pos = 8, time = 3)\n1819 %>% change_line(\"An evil is pulsating from $s2 in $s1.\", 'c', white) %>% change_on_screen(value = '$s2 at $s1.', pos = 8, time = 3)\n1820 %>% change_line(\"$s1 is currently asleep.\", 'c', white) %>% change_on_screen(value = '$s1 sleeping.', pos = 8, time = 3)\n1821 %>% change_line(\"$s2's evil presence is felt in $s1.\", 'c', white) %>% change_on_screen(value = '$s2 at $s1.', pos = 8, time = 3)\n1822 %>% change_line(\"$s1 has been sealed.\", 'c', white) %>% change_on_screen(value = '$s1 sealed.', pos = 8, time = 3)\n### Special cases\n  46 %>% change_line(\"You use $s1.\", 'c', white)\n  92 %>% change_line(\"[-] $s1\", 'c', buff_off) # $s1 has worn off.\n1068 %>% change_line(\"$s1 MP\", 'c', mp_recovery) # $s1 MP has been restored.\n\n 104 %>% change_line(\"You may not equip items while casting or performing a skill.\", 's', redish)\n 301 %>% change_line(\"$s2 $s1 has disappeared.\", 'c')\n 302 %>% change_line(\"$s1 has disappeared.\", 'c')\n 303 %>% change_line(\"Select item to enchant.\", 'c')\n 323 %>% change_line(\"Your force has increased to $s1 level.\", 'c', white)\n 324 %>% change_line(\"Your force has reached maximum capacity.\", 'c', white)\n 343 %>% change_line(\"Sweeper failed, target not spoiled.\", 's', redish)\n 347 %>% change_line(\"Incorrect item count.\", 's', red)\n 351 %>% change_line(\"Incorrect item count.\", 's', red)\n 419 %>% change_line(\"$s1 minute(s) of usage time left.\", 's', red)\n\n\n### Unchanged\n 614 %>% change_line(\">614<$s1 $s2\")\n1995 %>% change_line(\"$s1 channel filtering option\")\n1260 %>% change_line(\"Seven Signs: Preparations have begun for the next quest event.\", 's')\n1433 %>% change_line(\"Auto $s1 has been activated.\", 'c', grey)\n\n# Ungrouped ---------------------------------------------------------------\n1204 %>% change_line(\"The screenshot has been saved. ($s1 $s2x$s3)\", 's', white)\n1208 %>% change_line(\"$s1 died and dropped $s3 $s2.\", 'c', important_things)\n1209 %>% change_line(\"Congratulations. Your raid was successful.\", 's', important_things)\n1134 %>% change_line(\"HP increased. Effect of $s1 no longer active.\", 's') # Since HP has increased, the effect of $s1 will disappear.\n85 %>% change_line(\"\", 'd', red) %>% change_on_screen(\"Peaceful zone.\", 8, 1, 0) # You may not attack this target in a peaceful zone.\n\nif(FALSE){\n  # work stuff --------------------------------------------------------------\n  i <- 1280\n  sysmsg[i <- i+1,] %>% select(id, message, group, sub_msg); paste0(i-1, ' %>% change_line(\"',sysmsg[[i,'message']],'\", \\'\\', )') %>% writeClipboard()\n  sysmsg[i,'message']\n  sysmsg %>% filter(str_detect(message, 'by using Sweeper')) %>% select(id, message)\n  # end ---------------------------------------------------------------------\n  anti_join(sysmsg, unchanged) %>% inner_join(unchanged, by = \"id\") %>% select(id, old = message.y, new = message.x)\n}\n\n\nsysmsg %>% \n  write.table(file = \"sysmsg-e output.txt\", quote = FALSE, col.names = TRUE, row.names = FALSE, sep = '\\t', na = '')\n\n",
    "created" : 1472465020128.000,
    "dirty" : false,
    "encoding" : "ISO8859-1",
    "folds" : "",
    "hash" : "347858924",
    "id" : "A9DE988F",
    "lastKnownWriteTime" : 1488696730,
    "last_content_update" : 1488696730,
    "path" : "C:/Users/SarunasG/Google Drive/Projects/R/l2 editor c6/R/Systemmsg-e editor.R",
    "project_path" : "R/Systemmsg-e editor.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}